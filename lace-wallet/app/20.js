!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="48c7739a-0cf9-442e-a244-fa24344a4da3",e._sentryDebugIdIdentifier="sentry-dbid-48c7739a-0cf9-442e-a244-fa24344a4da3")}catch(s){}}();var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};e.SENTRY_RELEASE={id:"1.30.0-9d9ec3a"};"use strict";(self["webpackChunk_lace_browser_extension_wallet"]=self["webpackChunk_lace_browser_extension_wallet"]||[]).push([[20],{"./src/components/AssetSelectionButton/AssetCounter.tsx":(e,t,s)=>{s.d(t,{AssetsCounter:()=>AssetsCounter});var n=s("../../node_modules/react/index.js");var o=s("./src/components/AssetSelectionButton/AssetCounter.modules.scss");const AssetsCounter=({count:e})=>n.createElement("div",{className:o["default"].container,"data-testid":"assets-counter"},n.createElement("p",null,e))},"./src/components/AssetSelectionButton/SelectTokensButton.tsx":(e,t,s)=>{s.d(t,{SelectTokenButton:()=>SelectTokenButton});var n=s("../../node_modules/react/index.js");var o=s("../../packages/common/dist/index.esm.js");var a=s("./src/components/AssetSelectionButton/AssetCounter.tsx");var r=s("./src/components/AssetSelectionButton/SelectTokensButton.module.scss");const SelectTokenButton=({label:e,onClick:t,count:s=0,btnStyle:i,testId:l})=>n.createElement("div",{className:r["default"].container},s>0&&n.createElement(a.AssetsCounter,{count:s}),n.createElement(o.Button,{"data-testid":l,style:i,onClick:t,color:"secondary",variant:"outlined",className:r["default"].selectMultipleBtn},e))},"./src/components/ErrorBoundary/Crash.tsx":(e,t,s)=>{s.d(t,{Crash:()=>Crash});var n=s("../../node_modules/react/index.js");var o=s("../../node_modules/classnames/index.js");var a=s.n(o);var r=s("../../node_modules/react-i18next/dist/es/index.js");var i=s("../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");var l=s.n(i);var c=s("../../node_modules/style-loader/dist/runtime/styleDomAPI.js");var d=s.n(c);var u=s("../../node_modules/style-loader/dist/runtime/insertBySelector.js");var m=s.n(u);var v=s("../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js");var g=s.n(v);var p=s("../../node_modules/style-loader/dist/runtime/insertStyleElement.js");var S=s.n(p);var f=s("../../node_modules/style-loader/dist/runtime/styleTagTransform.js");var w=s.n(f);var E=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/components/ErrorBoundary/Crash.module.scss");var C={};C.styleTagTransform=w();C.setAttributes=g();C.insert=m().bind(null,"head");C.domAPI=d();C.insertStyleElement=S();var T=l()(E["default"],C);const h=E["default"]&&E["default"].locals?E["default"].locals:void 0;var k=s("../../node_modules/@input-output-hk/lace-ui-toolkit/dist/index.js");var A=s("../../node_modules/webextension-polyfill/dist/browser-polyfill.js");const useRuntime=()=>({reload:A.runtime.reload});const Crash=()=>{const{t:e}=(0,r.useTranslation)();const t=useRuntime();return n.createElement("div",{className:a()([h.crashContainer]),"data-testid":"crash"},n.createElement("p",{className:h.crashText,"data-testid":"crash-text"},e("general.errors.crash")),n.createElement(k.Button.CallToAction,{onClick:()=>t.reload(),label:e("general.errors.reloadExtension"),"data-testid":"crash-reload"}))}},"./src/components/ResultMessage/index.ts":(e,t,s)=>{s.d(t,{ResultMessage:()=>n.ResultMessage});var n=s("./src/components/ResultMessage/ResultMessage.tsx")},"./src/components/TransactionHashBox/index.ts":(e,t,s)=>{s.d(t,{TransactionHashBox:()=>n.TransactionHashBox});var n=s("./src/components/TransactionHashBox/TransactionHashBox.tsx")},"./src/components/TransitionAcknowledgmentDialog/index.ts":(e,t,s)=>{s.d(t,{TransitionAcknowledgmentDialog:()=>TransitionAcknowledgmentDialog});var n=s("../../node_modules/react/index.js");var o=s("../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");var a=s.n(o);var r=s("../../node_modules/style-loader/dist/runtime/styleDomAPI.js");var i=s.n(r);var l=s("../../node_modules/style-loader/dist/runtime/insertBySelector.js");var c=s.n(l);var d=s("../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js");var u=s.n(d);var m=s("../../node_modules/style-loader/dist/runtime/insertStyleElement.js");var v=s.n(m);var g=s("../../node_modules/style-loader/dist/runtime/styleTagTransform.js");var p=s.n(g);var S=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/components/TransitionAcknowledgmentDialog/TransitionAcknowledgmentDialog.module.scss");var f={};f.styleTagTransform=p();f.setAttributes=u();f.insert=c().bind(null,"head");f.domAPI=i();f.insertStyleElement=v();var w=a()(S["default"],f);const E=S["default"]&&S["default"].locals?S["default"].locals:void 0;var C=s("../../packages/common/dist/index.esm.js");var T=s("../../node_modules/antd/es/typography/index.js");var h=s("../../node_modules/antd/es/modal/index.js");var k=s("../../node_modules/antd/es/checkbox/index.js");var A=s("./src/utils/constants.ts");var x=s("../../node_modules/react-i18next/dist/es/index.js");const{Title:y,Text:b}=T["default"];const TransitionAcknowledgmentDialog=({visible:e,onClose:t,title:s,description:o,confirmationLabel:a,storageMemoEntryName:r})=>{const{t:i}=(0,x.useTranslation)();const[l,c]=(0,n.useState)(false);const onCheckboxChange=e=>{const t=e.target.checked;c(t);localStorage.setItem(r,String(t))};return n.createElement(h["default"],{centered:true,closable:false,footer:null,open:e,width:A.HW_POPUPS_WIDTH,className:E.transitionAcknowledgment,zIndex:1001},n.createElement(y,{level:3,className:E.title},s),n.createElement(b,{className:E.description},o),n.createElement("div",{className:E.buttons},n.createElement(C.Button,{onClick:t,block:true},a),n.createElement(k["default"],{checked:l,onChange:onCheckboxChange},n.createElement("span",{className:E.checkboxLabel},i("browserView.onboarding.sendTransitionAcknowledgment.dontShowAgain")))))}},"./src/features/address-book/store/index.tsx":(e,t,s)=>{s.d(t,{useAddressBookStore:()=>n.useAddressBookStore});var n=s("./src/features/address-book/store/addressBookStore.tsx")},"./src/features/notifications-center/index.ts":(e,t,s)=>{s.d(t,{NotificationsBellContainer:()=>n.NotificationsBellContainer});var n=s("./src/features/notifications-center/NotificationsBellContainer.tsx");var o=s("../../node_modules/react/index.js");var a=s("./src/components/Layout/index.ts");var r=s("../../node_modules/react-i18next/dist/es/index.js");var i=s("./src/views/browser-view/components/index.ts");var l=s("./src/hooks/useNotificationsCenter.ts");var c=s("./src/features/notifications-center/NotificationsList.tsx");var d=s("./src/features/notifications-center/EmptyState.tsx");var u=s("../../node_modules/@input-output-hk/lace-ui-toolkit/dist/index.js");var m=s("../../packages/common/dist/index.esm.js");var v=s("./src/components/Layout/SectionTitle.tsx");const NotificationsCenter=()=>{const{t:e}=useTranslation();const[t,s]=useState(false);const{notifications:n,remove:o,unreadNotifications:a}=useNotificationsCenter();const[r,i]=useState();const l=useHistory();const onShowRemoveNotificationModal=e=>{i(e);s(true)};const onHideRemoveNotificationModal=()=>{i(void 0);s(false)};const onGoToNotification=e=>{l.push(`/notification/${e}`)};const c=void 0===n;return React.createElement(ContentLayout,{title:React.createElement(SectionTitle,{isPopup:true,title:React.createElement(Flex,{alignItems:"center",gap:"$8"},React.createElement(NavigationButton,{icon:"arrow",onClick:()=>l.goBack()}),e("notificationsCenter.title")),sideText:`(${a})`,"data-testid":"notifications-center-title"}),isLoading:c},React.createElement("div",null,(null==n?void 0:n.length)>0?React.createElement(NotificationsList,{onClick:onGoToNotification,notifications:n,scrollableTarget:"contentLayout",dataLength:n.length,onRemove:onShowRemoveNotificationModal,popupView:true}):React.createElement(Box,{mt:"$96"},React.createElement(EmptyState,null))),React.createElement(WarningModal,{visible:t,header:e("notificationsCenter.removeNotification"),content:e("notificationsCenter.removeNotification.description"),onCancel:onHideRemoveNotificationModal,cancelLabel:e("notificationsCenter.removeNotification.cancel"),confirmLabel:e("notificationsCenter.removeNotification.confirm"),onConfirm:()=>{o(r);onHideRemoveNotificationModal()},isPopupView:true}))};const NotificationDetails=()=>{const{t:e}=useTranslation();const{unreadNotifications:t}=useNotificationsCenter();const s=useHistory();return React.createElement(ContentLayout,{title:React.createElement(SectionTitle,{isPopup:true,title:React.createElement(Flex,{alignItems:"center",gap:"$8"},React.createElement(NavigationButton,{icon:"arrow",onClick:()=>s.goBack()}),e("notificationsCenter.title")),sideText:`(${t})`,"data-testid":"notifications-details-title"})},React.createElement("div",null,React.createElement("h1",null,"Notification Details")))}},"./src/features/settings/components/Settings.tsx":(e,t,s)=>{var n=s("../../node_modules/react/index.js");var o=s("./src/components/Layout/index.ts");var a=s("../../node_modules/react-i18next/dist/es/index.js");var r=s("./src/features/settings/index.ts");var i=s("./src/views/browser-view/features/settings/components/SettingsRemoveWallet.tsx");const Settings=({defaultPassphraseVisible:e,defaultMnemonic:t})=>{const{t:s}=useTranslation();return React.createElement(ContentLayout,{title:s("settings.title"),"data-testid":"settings-page-title"},React.createElement("div",null,React.createElement(SettingsWallet,{popupView:true}),React.createElement(SettingsPreferences,{popupView:true}),React.createElement(SettingsSecurity,{popupView:true,defaultPassphraseVisible:e,defaultMnemonic:t}),React.createElement(SettingsHelp,{popupView:true}),React.createElement(SettingsLegal,null),React.createElement(SettingsRemoveWallet,{popupView:true})))}},"./src/providers/PostHogClientProvider/context.tsx":(e,t,s)=>{s.d(t,{PostHogClientProvider:()=>PostHogClientProvider,usePostHogClientContext:()=>usePostHogClientContext});var n=s("../../node_modules/zustand/esm/shallow.js");var o=s("../../node_modules/react/index.js");var a=s("./src/stores/index.ts");var r=s("./src/providers/PostHogClientProvider/client/index.ts");var i=s("./src/providers/AnalyticsProvider/getUserIdService.ts");var l=s("./src/providers/AnalyticsProvider/analyticsTracker/index.ts");var c=s("./src/providers/BackgroundServiceAPI/index.ts");const d=(0,i.getUserIdService)();const u=(0,o.createContext)(null);const usePostHogClientContext=()=>{const e=(0,o.useContext)(u);if(null===e)throw new Error("PostHogClientContext not defined");return e};const PostHogClientProvider=({children:e,postHogCustomClient:t})=>{const{getBackgroundStorage:s,setBackgroundStorage:i}=(0,c.useBackgroundServiceAPIContext)();const{currentChain:m,view:v}=(0,a.useWalletStore)(e=>{return{currentChain:null==e?void 0:e.currentChain,view:e.walletUI.appMode}},n["default"]);const g=(0,o.useMemo)(()=>t||r.PostHogClient.getInstance(m,d,{getBackgroundStorage:s,setBackgroundStorage:i},"popup"===v?l.ExtensionViews.Popup:l.ExtensionViews.Extended),[m,s,t,i,v]);(0,o.useEffect)(()=>()=>g.shutdown(),[g]);return o.createElement(u.Provider,{value:g},e)}},"./src/providers/UIThemeProvider/context.tsx":(e,t,s)=>{s.d(t,{UIThemeProvider:()=>UIThemeProvider});var n=s("../../node_modules/react/index.js");var o=s("../../node_modules/@input-output-hk/lace-ui-toolkit/dist/index.js");var a=s.n(o);var r=s("./src/providers/ThemeProvider/index.ts");const UIThemeProvider=({children:e})=>{const{theme:t}=(0,r.useTheme)();return n.createElement(o.ThemeProvider,{colorScheme:"light"===t.name?o.ThemeColorScheme.Light:o.ThemeColorScheme.Dark},e)}},"./src/routes/PopupView.tsx":(e,t,s)=>{var n=s("../../node_modules/react/index.js");var o=s("../../packages/core/dist/index.esm.js");var a=s("../../packages/common/dist/index.esm.js");var r=s("../../node_modules/react-i18next/dist/es/index.js");var i=s("../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");var l=s.n(i);var c=s("../../node_modules/style-loader/dist/runtime/styleDomAPI.js");var d=s.n(c);var u=s("../../node_modules/style-loader/dist/runtime/insertBySelector.js");var m=s.n(u);var v=s("../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js");var g=s.n(v);var p=s("../../node_modules/style-loader/dist/runtime/insertStyleElement.js");var S=s.n(p);var f=s("../../node_modules/style-loader/dist/runtime/styleTagTransform.js");var w=s.n(f);var E=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/features/receive-info/components/ReceiveInfo.module.scss");var C={};C.styleTagTransform=w();C.setAttributes=g();C.insert=m().bind(null,"head");C.domAPI=d();C.insertStyleElement=S();var T=l()(E["default"],C);const h=E["default"]&&E["default"].locals?E["default"].locals:void 0;var k=s("./src/providers/ThemeProvider/index.ts");var A=s("./src/providers/index.ts");var x=s("./src/providers/AnalyticsProvider/analyticsTracker/index.ts");var y=s("../../node_modules/@input-output-hk/lace-ui-toolkit/dist/index.js");var b=s("./src/lib/scripts/types/index.ts");var R=s("./src/views/browser-view/components/index.ts");var P=s("./src/hooks/index.ts");const D=null;const ReceiveInfo_ReceiveInfo=({name:e,address:t,handles:s,goBack:n})=>{const o=useAnalyticsContext();const{t:a}=useTranslation();const{theme:r}=useTheme();const i=useBackgroundServiceAPIContext();const[l,c]=useState(false);const[,{updateLocalStorage:d}]=useLocalStorage("isReceiveInAdvancedMode",false);const handleOnClose=()=>{n();o.sendEventToPostHog(PostHogAction.ReceiveYourWalletAddressXClick)};const handleCopyAdaHandle=()=>{o.sendEventToPostHog(PostHogAction.ReceiveCopyADAHandleIconClick)};const handleCopyAddress=()=>{o.sendEventToPostHog(PostHogAction.ReceiveCopyAddressIconClick)};const openTabExtensionReceiveFlow=()=>{d(true);i.handleOpenBrowser({section:BrowserViewSections.RECEIVE_ADVANCED})};return React.createElement(React.Fragment,null,React.createElement(Drawer,{open:true,onClose:handleOnClose,title:React.createElement(DrawerHeader,{title:a("qrInfo.receive"),subtitle:React.createElement(Box,{className:styles.subTitle},a("qrInfo.scanQRCodeToConnectWallet"),D&&React.createElement(Flex,{mt:"$20",justifyContent:"space-between"},React.createElement("span",null,a("qrInfo.advancedMode.toggle.label")),React.createElement(ToggleSwitch,{icon:React.createElement(Tooltip,{title:a("qrInfo.advancedMode.toggle.description")},React.createElement(InfoCircleOutlined,null)),defaultChecked:l,checked:l,onCheckedChange:()=>c(true),testId:"advanced-mode-"})))}),navigation:React.createElement(DrawerNavigation,{onCloseIconClick:handleOnClose}),popupView:true},React.createElement(Flex,{className:styles.container,testId:"receive-address-qr",flexDirection:"column",gap:"$16"},React.createElement(AddressCard,{name:e,isPopupView:true,address:null==t?void 0:t.toString(),getQRCodeOptions:useCallback(()=>getQRCodeOptions(r,ADDRESS_CARD_QR_CODE_SIZE_POPUP),[r]),onCopyClick:handleCopyAddress}),null==s?void 0:s.map(({nftMetadata:e,image:t})=>React.createElement(HandleAddressCard,{key:e.name,name:e.name,image:getAssetImageUrl(t||e.image),copiedMessage:a("core.infoWallet.handleCopied"),onCopyClick:handleCopyAdaHandle})))),React.createElement(WarningModal,{header:a("qrInfo.advancedMode.modal.title"),content:React.createElement("span",{className:styles.removeWalletContent},a("qrInfo.advancedMode.modal.description")),visible:l,onCancel:()=>c(false),onConfirm:openTabExtensionReceiveFlow,cancelLabel:a("qrInfo.advancedMode.modal.cancel"),confirmLabel:a("qrInfo.advancedMode.modal.confirm"),confirmCustomClassName:styles.settingsConfirmButton,isPopupView:true}))};var I=s("./src/routes/index.ts");var _=s("./src/stores/index.ts");var N=s("./src/hooks/useGetHandles.ts");const ReceiveInfoContainer_ReceiveInfoContainer=()=>{const e=useRedirection(walletRoutePaths.assets);const{walletInfo:t}=useWalletStore();const s=useGetHandles();const n=useMemo(()=>{const e=[...t.addresses];return e.sort((e,t)=>e.index-t.index)},[t.addresses]);return React.createElement(ReceiveInfo,{name:null==t?void 0:t.name,address:n[0].address,handles:s,goBack:e})};var M=s("../../node_modules/lodash/debounce.js");var V=s("./src/components/Layout/index.ts");var F=s("./src/views/browser-view/features/activity/index.ts");var B=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/features/activity/components/Activity.module.scss");var W={};W.styleTagTransform=w();W.setAttributes=g();W.insert=m().bind(null,"head");W.domAPI=d();W.insertStyleElement=S();var H=l()(B["default"],W);const L=B["default"]&&B["default"].locals?B["default"].locals:void 0;var j=s("./src/hooks/useWalletActivities.ts");const O=300;const Activity_Activity=()=>{const{t:e}=useTranslation();const{priceResult:t}=useFetchCoinPrice();const{walletInfo:s,activityDetail:n,resetActivityState:o}=useWalletStore();const a=`${e("browserView.activity.title")}`;const r=useRedirection(walletRoutePaths.assets);const i=useAnalyticsContext();const l=useCallback(()=>{i.sendEventToPostHog(PostHogAction.ActivityActivityActivityRowClick)},[i]);const{walletActivities:c,mightHaveMore:d,loadedTxLength:u,loadMore:m,retry:v,error:g}=useWalletActivitiesPaginated({sendAnalytics:l});const p=useMemo(()=>debounce(m,O),[m]);return React.createElement(ContentLayout,{title:a,isLoading:void 0===c},React.createElement(Drawer,{open:!!n,onClose:o,navigation:React.createElement(DrawerNavigation,{onArrowIconClick:o,onCloseIconClick:()=>{i.sendEventToPostHog(PostHogAction.ActivityActivityDetailXClick);o();r()}}),popupView:true},n&&t&&React.createElement(ActivityDetail,{price:t})),React.createElement("div",{className:styles.activitiesContainer},(null==c?void 0:c.length)>0&&React.createElement(GroupedAssetActivityList,{hasMore:d,loadMore:p,lists:c,scrollableTarget:"contentLayout",dataLength:u,loadingError:g,retryLoading:v}),(null==c?void 0:c.length)===0&&React.createElement("div",{className:styles.emptyState},React.createElement(FundWalletBanner,{title:e("browserView.assets.welcome"),subtitle:e("browserView.activity.fundWalletBanner.title"),prompt:e("browserView.fundWalletBanner.prompt"),walletAddress:s.addresses[0].address.toString()}))))};const PopupAssets_PopupAssets=()=>React.createElement(AssetsView,null);var U=s("./src/views/browser-view/features/assets/index.ts");var Z=s("./src/views/browser-view/features/send-transaction/index.ts");var G=s("./src/views/browser-view/features/send-transaction/components/SendTransactionDrawer/index.ts");var X=s("./src/components/ContinueInBrowserDialog/index.ts");var $=s("./src/providers/BackgroundServiceAPI/index.ts");var K=s("./src/views/browser-view/features/send-transaction/components/SendTransactionDrawer/HeaderView.tsx");var Y=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/features/send/components/Send.module.scss");var q={};q.styleTagTransform=w();q.setAttributes=g();q.insert=m().bind(null,"head");q.domAPI=d();q.insertStyleElement=S();var z=l()(Y["default"],q);const Q=Y["default"]&&Y["default"].locals?Y["default"].locals:void 0;var J=s("./src/views/browser-view/features/send-transaction/helpers.ts");const ee="output1";const Send_Send=()=>{const{t:e}=useTranslation();const[t,s]=useState(false);const toggleContinueDialog=()=>s(!t);const{currentSection:{currentSection:n},setSection:o}=useSections();const a=useBackgroundServiceAPIContext();const[r]=useMultipleSelection();const{uiOutputs:i}=useCoinStateSelector(ee);const{address:l}=useAddressState(ee);const openTabExtensionSendFlow=()=>{saveTemporaryTxDataInStorage({tempAddress:l,tempOutputs:i,tempSource:"hardware-wallet"});return a.handleOpenBrowser({section:BrowserViewSections.SEND_ADVANCED})};const c=r&&n===Sections.ASSET_PICKER;const d=![Sections.ADDRESS_LIST,Sections.ADDRESS_FORM,Sections.ASSET_PICKER].includes(n)||c;return React.createElement(React.Fragment,null,React.createElement(ContinueInBrowserDialog,{visible:t,onConfirm:openTabExtensionSendFlow,onClose:toggleContinueDialog,title:e("browserView.onboarding.hardwareWalletSendTransition.title"),description:e("browserView.onboarding.hardwareWalletSendTransition.description"),okLabel:e("browserView.onboarding.hardwareWalletSendTransition.ok"),cancelLabel:e("browserView.onboarding.hardwareWalletSendTransition.cancel")}),React.createElement(Drawer,{visible:true,navigation:React.createElement(HeaderNavigation,{isPopupView:true}),title:React.createElement("div",{className:styles.headerTitleContainer},React.createElement(HeaderTitle,{popup:true})),footer:d&&React.createElement(Footer,{isPopupView:true,openContinueDialog:toggleContinueDialog,onHandleChangeConfirm:()=>o({currentSection:Sections.FORM,nextSection:Sections.SUMMARY})}),popupView:true},React.createElement(Transaction,{flow:"send",isPopupView:true})))};var et=s("./src/routes/wallet-paths.ts");var es=s("./src/hooks/useMultiDelegationEnabled.ts");var en=s("../../packages/staking/dist/index.js");var eo=s("./src/features/delegation/stores/index.ts");var ea=s("./src/utils/format-number.ts");var er=s("./src/components/Layout/SectionTitle.tsx");var ei=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/features/delegation/components/DelegationLayout.module.scss");var el={};el.styleTagTransform=w();el.setAttributes=g();el.insert=m().bind(null,"head");el.domAPI=d();el.insertStyleElement=S();var ec=l()(ei["default"],el);const ed=ei["default"]&&ei["default"].locals?ei["default"].locals:void 0;var eu=s("./src/utils/constants.ts");var em=s("./src/lib/wallet-api-ui.ts");var ev=s("./src/views/browser-view/features/staking/index.ts");var eg=s("./src/views/browser-view/features/staking/hooks.ts");var ep=s("./src/lib/scripts/background/util.ts");function _extends(){_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)if(Object.prototype.hasOwnProperty.call(s,n))e[n]=s[n]}return e};return _extends.apply(this,arguments)}const MultiDelegationStakingPopup_MultiDelegationStakingPopup=()=>{var e,t,s,n,o;const{t:a}=useTranslation();const{theme:r}=useTheme();const{handleOpenBrowser:i}=useBackgroundServiceAPIContext();const{delegationTxBuilder:l,setDelegationTxBuilder:c,delegationTxFee:d,setDelegationTxFee:u}=useDelegationStore();const m=useExternalLinkOpener();const v=useSecrets();const g=useSubmitingState();const{priceResult:p}=useFetchCoinPrice();const{balance:S}=useBalances(null==p?void 0:null===(e=p.cardano)||void 0===e?void 0:e.price);const f=useStakingRewards();const{walletRepository:w}=useWalletManager();const{getCustomSubmitApiForNetwork:E}=useCustomSubmitApi();const{walletType:C,inMemoryWallet:T,walletUI:{cardanoCoin:h},stakePoolSearchResults:k,stakePoolSearchResultsStatus:A,fetchStakePools:x,fetchNetworkInfo:y,networkInfo:b,blockchainProvider:R,walletInfo:P,currentChain:D,environmentName:I,isSharedWallet:_}=useWalletStore(e=>({walletType:e.walletType,inMemoryWallet:e.inMemoryWallet,walletUI:{cardanoCoin:e.walletUI.cardanoCoin},stakePoolSearchResults:e.stakePoolSearchResults,stakePoolSearchResultsStatus:e.stakePoolSearchResultsStatus,fetchStakePools:e.fetchStakePools,networkInfo:e.networkInfo,fetchNetworkInfo:e.fetchNetworkInfo,blockchainProvider:e.blockchainProvider,walletInfo:e.walletInfo,currentChain:e.currentChain,environmentName:e.environmentName,isSharedWallet:e.isSharedWallet}));const N=useCurrentWallet();const M=useObservable(w.wallets$);const V=null===(t=getParentWalletForCIP1854Account({wallets:M,activeWallet:N}))||void 0===t?void 0:t.account;const F=useSignPolicy(N,"staking");const B=useCallback(()=>{const e={sendEvent:()=>{}};e.sendEvent({action:"AnalyticsEventActions.CLICK_EVENT",category:"AnalyticsEventCategories.STAKING",name:"AnalyticsEventNames.Staking.STAKING_MULTI_DELEGATION_POPUP"})},[]);const{walletActivities:W,walletActivitiesStatus:H}=useWalletActivities({sendAnalytics:B});const{fiatCurrency:L}=useCurrencyStore();const j=useWalletStore(networkInfoStatusSelector);const[O,{updateLocalStorage:U}]=useLocalStorage(MULTIDELEGATION_FIRST_VISIT_LS_KEY,true);const[Z,{updateLocalStorage:G}]=useLocalStorage(MULTIDELEGATION_DAPP_COMPATIBILITY_LS_KEY,true);const[X,{updateLocalStorage:$}]=useLocalStorage(STAKING_BROWSER_PREFERENCES_LS_KEY,DEFAULT_STAKING_BROWSER_PREFERENCES);const K=null===(n=null===(s=P.addresses)||void 0===s?void 0:s[0].address)||void 0===n?void 0:n.toString();const Y=P.name;const q=useAnalyticsContext();useEffect(()=>{y()},[y,R]);return React.createElement(OutsideHandlesProvider,_extends({},{analytics:q,stakingBrowserPreferencesPersistence:X,setStakingBrowserPreferencesPersistence:$,multidelegationFirstVisit:O,triggerMultidelegationFirstVisit:()=>{U(false)},multidelegationDAppCompatibility:Z,triggerMultidelegationDAppCompatibility:()=>G(false),expandStakingView:e=>i({section:BrowserViewSections.STAKING,urlSearchParams:e}).then(()=>window.close()),balancesBalance:S,delegationStoreSetDelegationTxBuilder:c,delegationStoreDelegationTxBuilder:l,delegationStoreSetDelegationTxFee:u,delegationStoreDelegationTxFee:d,fetchCoinPricePriceResult:p,openExternalLink:m,password:v,stakingRewards:f,submittingState:g,walletManagerExecuteWithPassword:withSignTxConfirmation,walletStoreWalletType:C,walletStoreInMemoryWallet:T,walletStoreWalletUICardanoCoin:h,currencyStoreFiatCurrency:L,walletStoreStakePoolSearchResults:k,walletStoreStakePoolSearchResultsStatus:A,walletStoreFetchStakePools:x,walletStoreFetchNetworkInfo:y,walletStoreNetworkInfo:b,walletStoreBlockchainProvider:R,walletStoreWalletActivities:W,walletStoreWalletActivitiesStatus:H,compactNumber:compactNumberWithUnit,walletAddress:K,walletName:Y,currentChain:D,isMultidelegationSupportedByDevice,isCustomSubmitApiEnabled:E(I).status,isSharedWallet:_,signPolicy:F,sharedWalletKey:null==V?void 0:V.extendedAccountPublicKey,coSigners:null==N?void 0:null===(o=N.metadata)||void 0===o?void 0:o.coSigners,useRewardAccountsData,votingCenterUrl:walletRoutePaths.voting,parseError}),React.createElement(ContentLayout,{title:React.createElement(SectionTitle,{title:a("staking.sectionTitle"),classname:styles.sectionTilte}),isLoading:j},React.createElement(StakingPopup,{theme:r.name})))};var eS=s("../../node_modules/lodash/isNumber.js");var ef=s("../../packages/cardano/dist/index.esm.js");var ew=s("./src/stores/selectors/staking-selectors.ts");var eE=s("./src/api/transformers.ts");var eC=s("./src/views/browser-view/features/staking/components/StakePoolDetails/index.tsx");var eT=s("./src/views/browser-view/features/staking/components/StakingModals/index.tsx");var eh=s("./src/views/browser-view/features/staking/types/index.ts");var ek=s("./src/features/stake-pool-details/store/index.ts");var eA=s("../../node_modules/antd/es/typography/index.js");var ex=s("./src/views/browser-view/features/staking/components/StakeFundsBanner/index.ts");var ey=s("./src/views/browser-view/features/staking/components/StakingInfo/index.ts");var eb,eR;function expand_gradient_component_extends(){expand_gradient_component_extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)if(Object.prototype.hasOwnProperty.call(s,n))e[n]=s[n]}return e};return expand_gradient_component_extends.apply(this,arguments)}var SvgExpandGradientcomponent=function SvgExpandGradientcomponent(e){return React.createElement("svg",expand_gradient_component_extends({width:"1em",height:"1em",viewBox:"0 0 25 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),eb||(eb=React.createElement("path",{d:"M3.5 8a1 1 0 0 0 2 0h-2Zm1-4V3a1 1 0 0 0-1 1h1Zm4 1a1 1 0 0 0 0-2v2Zm11 3a1 1 0 1 0 2 0h-2Zm1-4h1a1 1 0 0 0-1-1v1Zm-4-1a1 1 0 1 0 0 2V3Zm-11 13a1 1 0 1 0-2 0h2Zm-1 4h-1a1 1 0 0 0 1 1v-1Zm4 1a1 1 0 1 0 0-2v2Zm1.707-5.293a1 1 0 0 0-1.414-1.414l1.414 1.414Zm4.586-7.414a1 1 0 0 0 1.414 1.414l-1.414-1.414Zm-6 1.414a1 1 0 0 0 1.414-1.414L8.793 9.707ZM20.5 20v1a1 1 0 0 0 1-1h-1Zm-4.293-5.707a1 1 0 0 0-1.414 1.414l1.414-1.414ZM21.5 16a1 1 0 1 0-2 0h2Zm-5 3a1 1 0 1 0 0 2v-2ZM5.5 8V4h-2v4h2Zm-1-3h4V3h-4v2Zm17 3V4h-2v4h2Zm-1-5h-4v2h4V3Zm-17 13v4h2v-4h-2Zm1 5h4v-2h-4v2Zm.707-.293 5-5-1.414-1.414-5 5 1.414 1.414Zm11-11 5-5-1.414-1.414-5 5 1.414 1.414Zm-6-1.414-5-5-1.414 1.414 5 5 1.414-1.414Zm11 11-5-5-1.414 1.414 5 5 1.414-1.414ZM19.5 16v4h2v-4h-2Zm1 3h-4v2h4v-2Z",fill:"url(#expand-gradient_component_svg__a)"})),eR||(eR=React.createElement("defs",null,React.createElement("linearGradient",{id:"expand-gradient_component_svg__a",x1:1.572,y1:1.072,x2:25.014,y2:2.801,gradientUnits:"userSpaceOnUse"},React.createElement("stop",{stopColor:"#FF92E1"}),React.createElement("stop",{offset:1,stopColor:"#FDC300"})))))};const eP=null;var eD=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/features/delegation/components/ExpandViewBanner/ExpandViewBanner.module.scss");var eI={};eI.styleTagTransform=w();eI.setAttributes=g();eI.insert=m().bind(null,"head");eI.domAPI=d();eI.insertStyleElement=S();var e_=l()(eD["default"],eI);const eN=eD["default"]&&eD["default"].locals?eD["default"].locals:void 0;const ExpandViewBanner_ExpandViewBanner=()=>{const{t:e}=useTranslation();const t=useBackgroundServiceAPIContext();return React.createElement("div",{className:styles.wrapper},React.createElement("div",{className:styles.container},React.createElement("div",{className:styles.title},e("staking.expandView.title")),React.createElement("div",{className:styles.description},e("staking.expandView.description")),React.createElement(Button,{onClick:()=>t.handleOpenBrowser({section:BrowserViewSections.STAKING}),className:styles.button,size:"large",color:"gradient"},React.createElement(Icon,{component:ExpandIcon,className:styles.icon}),e("staking.expandView.button"))))};function DelegationLayout_extends(){DelegationLayout_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)if(Object.prototype.hasOwnProperty.call(s,n))e[n]=s[n]}return e};return DelegationLayout_extends.apply(this,arguments)}const{Text:eM}=eA["default"];const DelegationLayout_DelegationLayout=({searchedPools:e,handleSearchChange:t,coinBalance:s,currentStakePool:n,fiat:o,isLoading:a,isSearching:r,hasNoFunds:i,isDelegating:l,canDelegate:c,walletAddress:d,totalRewards:u,lastReward:m,onStakePoolSelect:v,onStakePoolClick:g,cardanoCoin:p})=>{var S;const{t:f}=useTranslation();const w=useWalletStore(({stakePoolSearchResults:e})=>{return null==e?void 0:e.totalResultCount});const E=useExternalLinkOpener();const C=i||!i&&!l||l;const T={gettingSaturated:f("cardano.stakePoolSearch.gettingSaturated"),saturated:f("cardano.stakePoolSearch.saturated"),overSaturation:f("cardano.stakePoolSearch.overSaturated"),staking:f("cardano.stakePoolSearch.staking"),searchPlaceholder:f("cardano.stakePoolSearch.searchPlaceholder")};const{areAllRegisteredStakeKeysWithoutVotingDelegation:h,poolIdToRewardAccountsMap:k}=useRewardAccountsData();const A=!i&&h;return React.createElement(ContentLayout,{title:React.createElement(SectionTitle,{title:f("staking.sectionTitle"),classname:styles.sectionTilte}),isLoading:a},React.createElement("div",{className:styles.content},React.createElement(Skeleton,{loading:!isNumber(s)},React.createElement("div",{className:styles.contentWrapper},A&&React.createElement(Box,{mt:"$16"},React.createElement(RegisterAsDRepBanner,{openExternalLink:E,votingCenterUrl:walletRoutePaths.voting,popupView:true})),c&&React.createElement(StakeFundsBanner,{balance:s,popupView:true}),i&&React.createElement(FundWalletBanner,{title:f("browserView.assets.welcome"),subtitle:f("browserView.staking.fundWalletBanner.subtitle"),prompt:f("browserView.staking.fundWalletBanner.prompt"),walletAddress:null==d?void 0:d.toString(),shouldHaveVerticalContent:true}),l&&React.createElement(StakingInfo,DelegationLayout_extends({},{...n,rewardAccount:null===(S=k.get(n.id))||void 0===S?void 0:S[0],coinBalance:s,fiat:o,totalRewards:u,lastReward:m,cardanoCoin:p},{onStakePoolSelect:v,popupView:true})),React.createElement("div",null,React.createElement("div",{className:styles.title},React.createElement("h1",{className:styles.subHeader},f("staking.stakePools.sectionTitle")),React.createElement(eM,{"data-testid":"section-title-counter",className:styles.sideText},"(",w||0,")")),React.createElement(StakePoolSearch,{value:null,pools:e,onChange:t,isSearching:r,onStakePoolClick:g,translations:T,withSuggestions:true})),C&&React.createElement(ExpandViewBanner,null)))))};var eV=s("./src/components/TransitionAcknowledgmentDialog/index.ts");const eF="hideStakingHwDialog";const eB=3;const eW=3;const eH=new Set([eh.Sections.CONFIRMATION,eh.Sections.SIGN,eh.Sections.FAIL_TX,eh.Sections.SUCCESS_TX]);const eL=new Set([eh.Sections.CONFIRMATION,eh.Sections.SIGN]);const ej=new Set([eh.Sections.DETAIL,eh.Sections.CONFIRMATION,eh.Sections.SIGN]);const DelegationContent_DelegationContent=()=>{var e,t,s,n;const{t:o}=useTranslation();const{isInMemoryWallet:a,walletUI:{cardanoCoin:r},blockchainProvider:i}=useWalletStore();const[l,c]=useState();const d=useRedirection(walletRoutePaths.receive);const u="true"===localStorage.getItem(eF);const m=!u&&!a;const[v,g]=useState(m);const toggleisTransitionAcknowledgmentDialog=()=>g(!v);const p=useWalletStore(networkInfoStatusSelector);const{stakePoolSearchResults:S,isSearching:f,fetchStakePools:w}=useWalletStore(stakePoolResultsSelector);const{setSelectedStakePool:E}=useDelegationStore();const{setStakeConfirmationVisible:C,setIsDrawerVisible:T,setSection:h}=useStakePoolDetails();const{inMemoryWallet:k,walletInfo:A}=useWalletStore();const{totalRewards:x,lastReward:y}=useStakingRewards();const b=useObservable(k.delegation.rewardAccounts$);const R=useObservable(null==k?void 0:k.protocolParameters$);const{coinBalance:P}=walletBalanceTransformer(null==R?void 0:R.stakeKeyDeposit.toString());const{priceResult:D}=useFetchCoinPrice();const{balance:I}=useBalances(null==D?void 0:null===(e=D.cardano)||void 0===e?void 0:e.price);const _=useAnalyticsContext();const N=useDelegationDetails();const M=b&&b[0].credentialStatus===Wallet.Cardano.StakeCredentialStatus.Registered;const V=(null==I?void 0:null===(t=I.total)||void 0===t?void 0:t.coinBalance)&&Number(null==I?void 0:null===(s=I.total)||void 0===s?void 0:s.coinBalance);const F=V<Number(P)&&!M||0===V&&M;const B=!!(b&&N);const W=!B&&isNumber(V)&&!F;const handleSearch=e=>c(null!=e?e:"");const onStakePoolSelect=e=>{E(e);T(true)};const parseStakePools=()=>{return null==S?void 0:S.pageResults.map(e=>{var t;return e?Wallet.util.stakePoolTransformer({stakePool:e,delegatingPoolId:null==N?void 0:null===(t=N.id)||void 0===t?void 0:t.toString(),cardanoCoin:r}):void 0})};useEffect(()=>{if((null==l?void 0:l.length)!==0&&(null==l?void 0:l.length)<eB)return;w({searchString:l||"",limit:eW})},[l,w,a,i]);const H=useCallback(()=>{h()},[h]);const L=useCallback(()=>{if(B){C(true);return}H();T(true)},[B,C,H,T]);const sendAnalytics=()=>{_.sendEventToPostHog(PostHogAction.StakingStakePoolClick)};return React.createElement(React.Fragment,null,React.createElement(TransitionAcknowledgmentDialog,{visible:v,onClose:toggleisTransitionAcknowledgmentDialog,title:o("browserView.onboarding.stakingTransitionAcknowledgment.title"),description:o("browserView.onboarding.stakingTransitionAcknowledgment.description"),confirmationLabel:o("browserView.onboarding.stakingTransitionAcknowledgment.iUnderstand"),storageMemoEntryName:"hideStakingHwDialog"}),React.createElement(DelegationLayout,{searchedPools:(null==l?void 0:l.length)&&!((null==l?void 0:l.length)>=eB)?[]:parseStakePools(),coinBalance:V,searchValue:l,handleSearchChange:handleSearch,handleAddFunds:d,currentStakePool:N&&Wallet.util.stakePoolTransformer({stakePool:N,cardanoCoin:r}),isLoading:p,totalRewards:Wallet.util.lovelacesToAdaString(x.toString()),lastReward:Wallet.util.lovelacesToAdaString(y.toString()),isSearching:f,hasNoFunds:F,isDelegating:B,canDelegate:W,walletAddress:null==A?void 0:A.addresses[0].address,fiat:null==D?void 0:null===(n=D.cardano)||void 0===n?void 0:n.price,onStakePoolSelect:()=>onStakePoolSelect(N),onStakePoolClick:e=>{sendAnalytics();c("");E(S.pageResults.find(t=>{var s;return(null==t?void 0:null===(s=t.id)||void 0===s?void 0:s.toString())===e}));T(true)},cardanoCoin:r}),React.createElement(StakePoolDetails,{showCloseIcon:e=>eH.has(e),showBackIcon:e=>ej.has(e),showExitConfirmation:e=>eL.has(e),canDelegate:!F,onStake:L,popupView:true}),React.createElement(StakingModals,{popupView:true}))};const DelegationContainer_DelegationContainer=()=>{const e=useMultiDelegationEnabled();return React.createElement(React.Fragment,null,e?React.createElement(MultiDelegationStakingPopup,null):React.createElement(DelegationContent,null))};var eO=s("./src/views/browser-view/features/adress-book/components/AddressBookEmpty/index.tsx");var eU=s("./src/features/address-book/context/index.ts");var eZ=s("./src/features/address-book/components/AddressDetailDrawer/index.ts");var eG=s("./src/features/address-book/store/index.tsx");var eX=s("./src/features/address-book/components/AddressBook.modules.scss");var e$=s("./src/assets/icons/delete-icon.component.svg");var eK=s("./src/assets/icons/plus-icon.svg");var eY=s("./src/features/address-book/components/AddressDetailDrawer/types/index.ts");var eq=s("./src/features/ada-handle/config.ts");const ez="popupAddressBookContainerId";const eQ=(0,eU.withAddressBookContext)(()=>{var e,t,s,i;const[l,c]=(0,n.useState)(false);const{list:d,count:u,utils:m}=(0,eU.useAddressBookContext)();const{extendLimit:v,deleteRecord:g}=m;const{setIsEditAddressVisible:p,isEditAddressVisible:S,setAddressToEdit:f,addressToEdit:w}=(0,eG.useAddressBookStore)();const{t:E}=(0,r.useTranslation)();const C=(0,A.useAnalyticsContext)();const T=(0,P.useHandleResolver)();const h=(0,P.useUpdateAddressStatus)(d,T);const{onSaveAddressActions:k}=(0,P.useOnAddressSave)();const{setSection:y}=(0,Z.useSections)();const b={name:E("core.walletAddressList.name"),address:E("core.walletAddressList.address")};const onAddressSave=e=>k(e,w);var R;const D=(0,n.useMemo)(()=>{return(null==d?void 0:d.map(e=>{var t;return{id:e.id,address:e.address,name:e.name,onClick:e=>{var t;C.sendEventToPostHog(x.PostHogAction.AddressBookAddressRecordClick);f(e);if(eq.isAdaHandleEnabled&&(null===(t=h[e.address])||void 0===t?void 0:t.isValid)===false)c(true);else p(true)},isSmall:true,isAddressWarningVisible:null!==(R=eq.isAdaHandleEnabled&&(null===(t=h[e.address])||void 0===t?void 0:t.isValid)===false)&&void 0!==R&&R}}))||[]},[d,C,f,p,h]);const I=(0,n.useCallback)(()=>{v()},[v]);const handleAddAddressClick=()=>{p(true);C.sendEventToPostHog(x.PostHogAction.AddressBookAddAddressClick)};const _=(null==w?void 0:w.id)?eY.AddressDetailsSteps.DETAILS:eY.AddressDetailsSteps.CREATE;const onHandleDeleteContact=e=>{g(e,{text:E("browserView.addressBook.toast.deleteAddress"),icon:e$["default"]});f({})};var N,M;return n.createElement(n.Fragment,null,n.createElement(V.ContentLayout,{title:n.createElement("div",{className:eX["default"].title},n.createElement("h1",{"data-testid":"page-title"},E("addressBook.sectionTitle")," ",n.createElement("span",{className:eX["default"].subTitle,"data-testid":"counter"},"(",u,")"))),id:ez},n.createElement("div",{className:eX["default"].btnContainer},n.createElement(a.Button,{"data-testid":"add-address-button",color:"gradient",block:true,onClick:handleAddAddressClick},n.createElement("img",{src:eK["default"],alt:"plus-icon"}),E("addressBook.empty.addNewAddress"))),0===u?n.createElement("div",{className:eX["default"].emptyScreen,"data-testid":"empty-address-book"},n.createElement(eO.AddressBookEmpty,null)):n.createElement("div",{className:eX["default"].listContainer,"data-testid":"address-book-list"},n.createElement(o.WalletAddressList,{scrollableTargetId:ez,className:eX["default"].addressList,items:D,loadMoreData:I,locale:{emptyText:true},total:u,withHeader:false,popupView:true,translations:b}))),eq.isAdaHandleEnabled&&n.createElement(eZ.AddressChangeDetailDrawer,{visible:l,onCancelClick:()=>{f({});c(false);y({currentSection:Z.Sections.FORM})},expectedAddress:null!==(N=null===(e=h[w.address])||void 0===e?void 0:null===(t=e.error)||void 0===t?void 0:t.expectedAddress)&&void 0!==N?N:"",actualAddress:null!==(M=null===(s=h[w.address])||void 0===s?void 0:null===(i=s.error)||void 0===i?void 0:i.actualAddress)&&void 0!==M?M:"",initialValues:w,popupView:true}),n.createElement(eZ.AddressDetailDrawer,{initialStep:_,initialValues:w,onCancelClick:()=>{f({});p(false)},onConfirmClick:async e=>{await onAddressSave(e);f({})},onDelete:e=>onHandleDeleteContact(e),visible:S,popupView:true}))});var eJ=s("./src/features/settings/index.ts");var e0=s("./src/views/browser-view/features/sign-message/SignMessageDrawer.tsx");var e1=s("../../node_modules/lodash/flatten.js");var e4=s.n(e1);var e2=s("../../node_modules/antd/es/skeleton/index.js");var e5=s("../../node_modules/lodash/isNil.js");var e3=s.n(e5);var e7=s("./src/features/nfts/components/Nfts.module.scss");var e8=s("./src/utils/get-token-list.ts");var e9=s("./src/assets/icons/new-folder-icon.component.svg");var e6=s("./src/views/browser-view/features/nfts/components/CreateFolder/CreateFolderDrawer.tsx");var te=s("./src/features/nfts/context/index.ts");var tt=s("./src/views/browser-view/features/nfts/components/RenameFolderDrawer.tsx");var ts=s("./src/views/browser-view/features/nfts/components/NftFolderConfirmationModal.tsx");var tn=s("./src/assets/icons/remove-folder.component.svg");var to=s("./src/hooks/useNftSearch.ts");const ta="contentLayout";const tr=10;const ti=(0,te.withNftsFoldersContext)(()=>{const e=(0,P.useRedirection)(I.walletRoutePaths.nftDetail);const[t,s]=(0,n.useState)(false);const{environmentName:i}=(0,_.useWalletStore)();const[l,c]=(0,n.useState)();const{walletInfo:d,inMemoryWallet:u}=(0,_.useWalletStore)();const{t:m}=(0,r.useTranslation)();const v=(0,P.useAssetInfo)();const{isSearching:g,handleSearch:p,filteredResults:S}=(0,to.useNftSearch)(v);const f=(0,a.useObservable)(u.balance.utxo.total$,eu.DEFAULT_WALLET_BALANCE.utxo.total$);const w=(0,A.useAnalyticsContext)();const{fiatCurrency:E}=(0,A.useCurrencyStore)();const[C,T]=(0,n.useState)();const[h,k]=(0,n.useState)();const[b,D]=(0,n.useState)(false);const[N,M]=(0,n.useState)(false);const{utils:{deleteRecord:F}}=(0,te.useNftsFoldersContext)();const[B,W]=(0,n.useState)("");const[H,L]=(0,n.useState)(false);const j=(0,n.useCallback)(t=>{w.sendEventToPostHog(x.PostHogAction.NFTsImageClick);e({params:{id:t.assetId.toString()}})},[w,e]);const O=(0,n.useMemo)(()=>{const{nftList:e}=(0,e8.getTokenList)({assetsInfo:v,balance:null==f?void 0:f.assets,environmentName:i,fiatCurrency:E});return e.map(e=>({...e,type:o.NftsItemsTypes.NFT,onClick:()=>j(e)}))},[null==f?void 0:f.assets,v,i,E,j]);const U=(0,n.useCallback)((e,t)=>[{label:m("browserView.nfts.contextMenu.rename"),onClick:()=>{D(true);T({id:e,name:t})}},{label:m("browserView.nfts.contextMenu.delete"),onClick:()=>{k(e);M(true)}}],[m]);const{list:Z}=(0,te.useNftsFoldersContext)();const G=(0,n.useMemo)(()=>{return(null==Z?void 0:Z.map(({name:e,assets:t,id:n})=>({id:n,name:e,type:o.NftsItemsTypes.FOLDER,nfts:t.map(e=>O.find(({assetId:t})=>t.toString()===e)).filter(e=>!!e),contextMenuItems:U(n,e),onClick:()=>{c(n);s(true)}})))||[]},[Z,O,U]);const X=(0,n.useMemo)(()=>G.find(({id:e})=>l===e),[l,G]);const $=e4()(null==Z?void 0:Z.map(({assets:e})=>e));const K=O.filter(({assetId:e})=>!$.includes(e));const Y=[...G,...K];const q=e3()(f)||e3()(Z);const onDeleteFolderConfirm=()=>{M(false);F(h,{text:m("browserView.nfts.deleteFolderSuccess"),icon:tn["default"]})};const z=(0,n.useCallback)(()=>{s(false);c(void 0)},[]);const handleNftSearch=(e,t)=>{W(t);if(!H){w.sendEventToPostHog(x.PostHogAction.NFTsSearchType);L(true)}p(e,t)};const Q=(0,n.useRef)(null);const J=""!==B?S:Y;return n.createElement(n.Fragment,null,n.createElement(V.ContentLayout,{id:ta,title:n.createElement(e2["default"],{loading:q},n.createElement("div",{className:e7["default"].sectionTitle},n.createElement(er.SectionTitle,{classname:e7["default"].title,title:m("browserView.nfts.pageTitle"),sideText:`(${O.length})`,isPopup:true}),O.length>0&&true&&n.createElement(a.Button,{className:e7["default"].newFolderBtn,color:"gradient",onClick:()=>{s(true);w.sendEventToPostHog(x.PostHogAction.NFTsCreateFolderClick)},"data-testid":"create-folder-button"},n.createElement(e9["default"],{className:e7["default"].newFolderIcon})))),mainClassName:e7["default"].nftsLayout},n.createElement("div",{className:e7["default"].nfts},n.createElement("div",{ref:Q,className:e7["default"].content,"data-testid":"nft-list-container"},n.createElement(e2["default"],{loading:q},Y.length>0?n.createElement(n.Fragment,null,Y.length>=tr&&n.createElement(y.SearchBox,{placeholder:m("browserView.nfts.searchPlaceholder"),onChange:e=>handleNftSearch(Y,e),"data-testid":"nft-search-input",value:B,onClear:()=>W("")}),!g&&""!==B&&0===S.length&&n.createElement(o.ListEmptyState,{message:m("core.assetSelectorOverlay.noMatchingResult"),icon:"sad-face"})):n.createElement(R.FundWalletBanner,{title:m("browserView.nfts.fundWalletBanner.title"),prompt:m("browserView.nfts.fundWalletBanner.prompt"),walletAddress:d.addresses[0].address.toString()})),n.createElement(o.NftGrid,{columns:2,scrollableTargetId:ta,items:q?[]:J,gridClassName:e7["default"].grid}))),n.createElement(e6.NFTFolderDrawer,{selectedFolder:X,onSelectNft:j,visible:t,onClose:z,isPopupView:true}),n.createElement(tt.RenameFolderDrawer,{folderToRename:C,visible:b,onClose:()=>D(false),isPopupView:true})),n.createElement(ts.NftFolderConfirmationModal,{onCancel:()=>M(false),visible:N,title:m("browserView.nfts.deleteFolderModal.header"),description:n.createElement(n.Fragment,null,n.createElement("div",null,m("browserView.nfts.deleteFolderModal.description1")),n.createElement("div",{className:"mt-3"},m("browserView.nfts.deleteFolderModal.description2"))),actions:[{body:m("browserView.nfts.deleteFolderModal.cancel"),dataTestId:"delete-folder-modal-cancel",color:"secondary",onClick:()=>M(false)},{dataTestId:"delete-folder-modal-confirm",onClick:onDeleteFolderConfirm,body:m("browserView.nfts.deleteFolderModal.confirm")}]}))});var tl=s("../../node_modules/react-router/esm/react-router.js");var tc=s("./src/views/browser-view/features/nfts/selectors.ts");var td=s("./src/hooks/useEnterKeyPress.ts");var tu=s("./src/providers/PostHogClientProvider/index.ts");var tm=s("./src/views/browser-view/features/nfts/components/NFTPrintLabDialog.tsx");function NftDetail_extends(){NftDetail_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)if(Object.prototype.hasOwnProperty.call(s,n))e[n]=s[n]}return e};return NftDetail_extends.apply(this,arguments)}const tv="https://nftprintlab.io/";const tg=(0,te.withNftsFoldersContext)(()=>{var e;const[t,s]=(0,n.useState)(false);const{inMemoryWallet:i,walletUI:{appMode:l},currentChain:c}=(0,_.useWalletStore)();const{t:d}=(0,r.useTranslation)();const u=(0,A.useAnalyticsContext)();const m=(0,tu.usePostHogClientContext)();const{setAvatar:v}=(0,P.useWalletAvatar)();const g=(0,P.useRedirection)(I.walletRoutePaths.nfts);const p=(0,P.useRedirection)(I.walletRoutePaths.send);const{id:S}=(0,tl.useParams)();const f=(0,P.useAssetInfo)();const w=(0,Z.useOutputInitialState)();const E=(0,A.useExternalLinkOpener)();const C=ef.Wallet.Cardano.AssetId(S);const T=null==f?void 0:f.get(C);const h=(0,a.useObservable)(i.balance.utxo.total$,eu.DEFAULT_WALLET_BALANCE.utxo.total$);const k=(null==h?void 0:null===(e=h.assets)||void 0===e?void 0:e.get(C))||BigInt(1);const y=(0,n.useMemo)(()=>ef.Wallet.util.calculateAssetBalance(k,T),[T,k]);const handleOpenSend=()=>{u.sendEventToPostHog(x.PostHogAction.SendClick,{trigger_point:Z.SendFlowTriggerPoints.NFTS});w(S,eu.SEND_NFT_DEFAULT_AMOUNT);p({params:{id:S}})};const handleSetAsAvatar=e=>{v(e);a.toast.notify({text:d("core.nftDetail.avatarUpdated")});u.sendEventToPostHog(x.PostHogAction.NFTDetailSetAsAvatarClick)};const b=(0,n.useCallback)(()=>{u.sendEventToPostHog(x.PostHogAction.NFTDetailPrintClick);s(true)},[u]);const R=(null==c?void 0:c.networkMagic)===ef.Wallet.Cardano.NetworkMagics.Mainnet;const D=R&&(null==m?void 0:m.isFeatureFlagEnabled("nftprintlab"));return n.createElement(n.Fragment,null,n.createElement(a.Drawer,{popupView:true,className:e7["default"].drawer,visible:true,navigation:n.createElement(a.DrawerNavigation,{onArrowIconClick:()=>g()}),dataTestId:"nft-details-drawer",footer:n.createElement("div",{className:e7["default"].footer},n.createElement(a.Button,{id:td.buttonIds.nftDetailsBtnId,className:e7["default"].sendBtn,onClick:handleOpenSend},d("core.nftDetail.sendNFT")))},T&&n.createElement(o.NftDetail,NftDetail_extends({},(0,tc.nftDetailSelector)(T),{isPopup:l===eu.APP_MODE_POPUP,amount:y,title:n.createElement("h2",{className:e7["default"].secondaryTitle},(0,tc.nftNameSelector)(T)),onSetAsAvatar:handleSetAsAvatar,onPrintNft:D?b:void 0}))),n.createElement(tm.NFTPrintLabDialog,{onCancel:()=>{u.sendEventToPostHog(x.PostHogAction.NFTPrintLabDisclaimerCancelClick);s(false)},open:t,onConfirm:()=>{u.sendEventToPostHog(x.PostHogAction.NFTPrintLabDisclaimerConfirmClick);const e=new URLSearchParams({pid:null==T?void 0:T.policyId,aid:T.assetId,name:T.tokenMetadata.name,aff:"LACE"});const t=`${tv}?${e.toString()}`;E(t);s(false)}}))});var tp=s("./src/config.ts");var tS=s("../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./src/features/voting-beta/components/Voting.module.scss");var tf={};tf.styleTagTransform=w();tf.setAttributes=g();tf.insert=m().bind(null,"head");tf.domAPI=d();tf.insertStyleElement=S();var tw=l()(tS["default"],tf);const tE=tS["default"]&&tS["default"].locals?tS["default"].locals:void 0;var tC=s("./src/views/browser-view/features/voting-beta/components/VotingCenterBanner/index.ts");const Voting_Voting=()=>{const e=useExternalLinkOpener();const{environmentName:t}=useWalletStore();const{GOV_TOOLS_URLS:s,TEMPO_VOTE_URLS:n}=config();const o=useAnalyticsContext();const a=useCallback(async t=>{await o.sendEventToPostHog(PostHogAction.VotingBannerButtonClick);e(t)},[o,e]);return React.createElement(ContentLayout,null,React.createElement("div",{className:styles.activitiesContainer},React.createElement("div",{className:styles.emptyState},React.createElement(VotingCenterBanner,{openExternalLink:a,govToolUrl:s[t],tempoVoteUrl:n[t],popupView:true}))))};var tT=s("./src/features/notifications-center/index.ts");var th=s("./src/hooks/useNotificationsCenterConfig.ts");const{GOV_TOOLS_URLS:tk}=(0,tp.config)();const ExtensionRoutes_ExtensionRoutes=()=>{const{isSharedWallet:e,environmentName:t}=useWalletStore();const s=!!tk[t];const{isNotificationsCenterEnabled:n}=useNotificationsCenterConfig();return React.createElement(MainLayout,null,React.createElement(Switch,null,React.createElement(Route,{exact:true,path:walletRoutePaths.assets,component:PopupAssets}),React.createElement(Route,{exact:true,path:walletRoutePaths.receive,component:ReceiveInfoContainer}),React.createElement(Route,{exact:true,path:walletRoutePaths.activity,component:Activity}),React.createElement(Route,{exact:true,path:walletRoutePaths.send,component:Send}),React.createElement(Route,{exact:true,path:walletRoutePaths.nftDetail,component:NftDetail}),n&&React.createElement(Route,{exact:true,path:walletRoutePaths.notifications,component:NotificationsCenter}),n&&React.createElement(Route,{exact:true,path:walletRoutePaths.notification,component:NotificationDetails}),!e&&React.createElement(Route,{exact:true,path:walletRoutePaths.earn,component:DelegationContainer}),React.createElement(Route,{exact:true,path:walletRoutePaths.addressBook,component:AddressBook}),React.createElement(Route,{exact:true,path:walletRoutePaths.settings,component:Settings}),React.createElement(Route,{exact:true,path:walletRoutePaths.signMessage,component:SignMessageDrawer}),React.createElement(Route,{exact:true,path:walletRoutePaths.nfts,component:Nfts}),s&&React.createElement(Route,{exact:true,path:walletRoutePaths.voting,component:Voting}),React.createElement(Route,{path:"*",render:()=>React.createElement(Redirect,{to:walletRoutePaths.assets})})),React.createElement(StakingWarningModals,{popupView:true}))};var tA=s("./src/providers/AppSettings/index.ts");var tx=s("./src/features/unlock-wallet/index.ts");var ty=s("../../node_modules/dayjs/dayjs.min.js");var tb=s.n(ty);var tR=s("../../node_modules/dayjs/plugin/duration.js");var tP=s.n(tR);var tD=s("./src/utils/local-storage.ts");var tI=s("./src/components/MainLoader/index.ts");var t_=s("./src/hooks/useFatalError.ts");var tN=s("./src/components/ErrorBoundary/index.ts");tb().extend(tP());const isLastValidationExpired=(e,t)=>{const s=dayjs(Number(e));const n=s.add(dayjs.duration({days:Number(t)}));return n.isBefore(dayjs())};const PopupView=()=>{const{cardanoWallet:e,walletDisplayInfo:t,inMemoryWallet:s,currentChain:n,walletInfo:o,isWalletLocked:a,walletLock:r,walletState:i,initialHdDiscoveryCompleted:l}=useWalletStore();const[{lastMnemonicVerification:c,mnemonicVerificationFrequency:d,chainName:u}]=useAppSettingsContext();const m=useBackgroundServiceAPIContext();const v=useAnalyticsContext();const[g,{updateLocalStorage:p}]=useLocalStorage(ENHANCED_ANALYTICS_OPT_IN_STATUS_LS_KEY,EnhancedAnalyticsOptInStatus.NotSet);useEffect(()=>{if(g!==EnhancedAnalyticsOptInStatus.OptedIn){p(EnhancedAnalyticsOptInStatus.OptedIn);v.setOptedInForEnhancedAnalytics(EnhancedAnalyticsOptInStatus.OptedIn)}},[v,g,p]);useAppInit();useEnterKeyPress();useEffect(()=>{const t=getValueFromLocalStorage("isForgotPasswordFlow");if(null===e&&!a()&&!t)null==m?void 0:m.handleOpenBrowser({section:BrowserViewSections.HOME}).then(()=>window.close())},[a,m,n,u,e]);const S=useFatalError();const f=useMemo(()=>!!e&&!!t&&o&&i&&s&&l,[e,o,i,s,l,t]);useEffect(()=>{if(f||S)removePreloaderIfExists()},[f,S]);const checkMnemonicVerificationFrequency=()=>d&&isLastValidationExpired(c,d);if(S){return React.createElement(Crash,null)}if(checkMnemonicVerificationFrequency()&&r){return React.createElement(UnlockWalletContainer,{validateMnemonic:true})}if(a()){return React.createElement(UnlockWalletContainer,null)}if(f){return React.createElement(ExtensionRoutes,null)}return React.createElement(MainLoader,null)}},"./src/stores/selectors/index.ts":(e,t,s)=>{s.d(t,{useSyncStatus:()=>o.useSyncStatus});var n=s("./src/stores/selectors/staking-selectors.ts");var o=s("./src/stores/selectors/sync-status-selector.ts")},"./src/stores/slices/activity-detail-slice.ts":(e,t,s)=>{s.d(t,{activityDetailSlice:()=>activityDetailSlice});var n=s("../../node_modules/lodash/isEmpty.js");var o=s.n(n);var a=s("./src/api/transformers.ts");var r=s("../../packages/cardano/dist/index.esm.js");var i=s("./src/utils/get-transaction-total-output.ts");var l=s("./src/utils/tx-inspection.ts");var c=s("../../node_modules/rxjs/dist/esm5/internal/firstValueFrom.js");var d=s("./src/utils/get-assets-information.ts");var u=s("../../packages/staking/dist/index.js");var m=s.n(u);var v=s("../../packages/core/dist/index.esm.js");var g=s("./src/utils/format-date.ts");var p=s("../../node_modules/@cardano-sdk/core/dist/esm/util/transactionSummaryInspector.js");var S=s("./src/utils/phase2-validation.ts");var f=s("./src/utils/era-slot-datetime.ts");var w=s("../../packages/common/dist/index.esm.js");const isConfirmedTransaction=e=>void 0!==e.blockHeader;const getTransactionAssetsId=(e,t)=>{const s=new Set;var n;const o=null!==(n=e.map(e=>e.value.assets))&&void 0!==n?n:[];if((null==t?void 0:t.size)>0)o.push(t);for(const a of o)if(a){for(const r of a.keys())s.has(r)||s.add(r)}return[...s.values()]};const transactionMetadataTransformer=e=>[...e.entries()].map(([e,t])=>({key:e.toString(),value:r.Wallet.cardanoMetadatumToObj(t)}));const shouldIncludeFee=(e,t,s)=>{if((0,S.hasPhase2ValidationFailed)(e)){return false}return!(t===v.DelegationActivityType.delegationRegistration||t===v.ConwayEraCertificatesTypes.Registration||(t===v.DelegationActivityType.delegationDeregistration||t===v.ConwayEraCertificatesTypes.Unregistration)&&!!(null==s?void 0:s.length))};const E=new Map;const getPoolInfos=async(e,t)=>{const s=[...e];const n=[];for(const o of e){const a=E.get(o);if(a){n.push(a);s.splice(s.indexOf(o),1)}}if(s.length>0){const r={filters:{identifier:{_condition:"or",values:s.map(e=>({id:e}))}},pagination:{startAt:0,limit:u.MAX_POOLS_COUNT}};const{pageResults:i}=await t.queryStakePools(r);i.forEach(e=>E.set(e.id,e));n.push(...i)}return n};const computeCollateral=async({addresses:e},t,s)=>await (0,p.getCollateral)(t,s,e.map(e=>e.address));const buildGetActivityDetail=({set:e,get:t})=>{return async({coinPrices:s,fiatCurrency:n})=>{var u,m,p;const{blockchainProvider:{chainHistoryProvider:S,stakePoolProvider:E,assetProvider:C,inputResolver:T},inMemoryWallet:h,activityDetail:k,walletInfo:A,walletState:x}=t();e({fetchingActivityInfo:true});if(k.type===v.TransactionActivityType.rewards){var y;const{activity:b,status:R,type:P}=k;const D=b.rewards.map(({poolId:e})=>e).filter(e=>!!e);const I=await getPoolInfos(D,E);e({fetchingActivityInfo:false});return{activity:{includedUtcDate:(0,g.formatDate)({date:b.spendableDate,format:"MM/DD/YYYY",type:"utc"}),includedUtcTime:`${(0,g.formatTime)({date:b.spendableDate,type:"utc"})} UTC`,rewards:{totalAmount:r.Wallet.util.lovelacesToAdaString(r.Wallet.BigIntMath.sum((null===(y=b.rewards)||void 0===y?void 0:y.map(({rewards:e})=>e))||[]).toString()),spendableEpoch:b.spendableEpoch,rewards:b.rewards.map(e=>{var t,s;const n=I.find(t=>t.id===e.poolId);return{amount:r.Wallet.util.lovelacesToAdaString(e.rewards.toString()),pool:e.poolId?{id:e.poolId,name:(null==n?void 0:null===(t=n.metadata)||void 0===t?void 0:t.name)||"-",ticker:(null==n?void 0:null===(s=n.metadata)||void 0===s?void 0:s.ticker)||"-"}:void 0}})}},status:R,type:P}}const{activity:_,status:N,type:M,direction:V}=k;const F=await (0,c.firstValueFrom)(h.assetInfo$);const B=await (0,c.firstValueFrom)(h.protocolParameters$);const W=getTransactionAssetsId(_.body.outputs);const H=await (0,d.getAssetsInformation)(W,F,{assetProvider:C,extraData:{nftMetadata:true,tokenMetadata:true}});const L=await (0,l.inspectTxValues)({addresses:A.addresses,tx:_,direction:V});const j=(null==L?void 0:null===(u=L.assets)||void 0===u?void 0:u.size)||0;const O=j+1;const U=await r.Wallet.getTxInputsValueAndAddress(_.body.inputs,S,h);const Z=U.map(e=>(0,a.inputOutputTransformer)(e,H,s,n));const G=_.body.outputs.map(e=>(0,a.inputOutputTransformer)(e,H,s,n));const X=(0,i.getTransactionTotalOutput)(_.body.outputs).minus(_.body.fee.toString());const $=r.Wallet.util.lovelacesToAdaString(X.toString());const K=o()(null===(m=_.auxiliaryData)||void 0===m?void 0:m.blob)?void 0:transactionMetadataTransformer(_.auxiliaryData.blob);const Y=r.Wallet.Cardano.util.computeImplicitCoin(B,_.body);const q=Y.deposit&&(M===v.DelegationActivityType.delegationRegistration||M===v.ConwayEraCertificatesTypes.Registration)?r.Wallet.util.lovelacesToAdaString(Y.deposit.toString()):void 0;const z=r.Wallet.util.calculateDepositReclaim(Y);const Q=z&&(M===v.DelegationActivityType.delegationDeregistration||M===v.ConwayEraCertificatesTypes.Unregistration)?r.Wallet.util.lovelacesToAdaString(z.toString()):void 0;const J=r.Wallet.util.lovelacesToAdaString(_.body.fee.toString());const ee=await computeCollateral(x,_,T);const et=ee>0?r.Wallet.util.lovelacesToAdaString(ee.toString()):void 0;const es=null===(p=_.body.certificates)||void 0===p?void 0:p.filter(e=>e.__typename===r.Wallet.Cardano.CertificateType.StakeDelegation);let en;let eo;if(isConfirmedTransaction(_)){var ea;const er=await (0,c.firstValueFrom)(h.eraSummaries$);const ei=(0,f.eraSlotDateTime)(er,null===(ea=_.blockHeader)||void 0===ea?void 0:ea.slot);en=ei.utcDate;eo=ei.utcTime}let el={hash:_.id.toString(),totalOutput:$,fee:shouldIncludeFee(_,M,es)?J:void 0,deposit:q,depositReclaim:Q,addrInputs:Z,addrOutputs:G,metadata:K,includedUtcDate:en,includedUtcTime:eo,collateral:et,votingProcedures:_.body.votingProcedures,proposalProcedures:_.body.proposalProcedures,certificates:_.body.certificates};if(M===v.DelegationActivityType.delegation&&es){const ec=await getPoolInfos(es.map(({poolId:e})=>e),E);if(0===ec.length)w.logger.error("Stake pool was not found for delegation tx");else el={...el,pools:ec.map(e=>{var t,s;return{name:(null===(t=e.metadata)||void 0===t?void 0:t.name)||"-",ticker:(null===(s=e.metadata)||void 0===s?void 0:s.ticker)||"-",id:e.id.toString()}})}}e({fetchingActivityInfo:false});return{activity:el,status:N,assetAmount:O,type:M}}};const activityDetailSlice=({set:e,get:t})=>({activityDetail:void 0,fetchingActivityInfo:true,getActivityDetail:buildGetActivityDetail({set:e,get:t}),setTransactionActivityDetail:({activity:t,direction:s,status:n,type:o})=>e({activityDetail:{activity:t,direction:s,status:n,type:o}}),setRewardsActivityDetail:({activity:t})=>e({activityDetail:{activity:t,status:v.ActivityStatus.SPENDABLE,type:v.TransactionActivityType.rewards}}),resetActivityState:()=>e({activityDetail:void 0,fetchingActivityInfo:false})})},"./src/views/browser-view/features/send-transaction/components/SendTransactionDrawer/Footer.tsx":(e,t,s)=>{s.d(t,{Footer:()=>M});var n=s("../../node_modules/react/index.js");var o=s("../../node_modules/react-i18next/dist/es/index.js");var a=s("../../packages/common/dist/index.esm.js");var r=s("../../packages/cardano/dist/index.esm.js");var i=s("./src/views/browser-view/features/send-transaction/components/SendTransactionDrawer/Footer.module.scss");var l=s("./src/assets/icons/edit.component.svg");var c=s("./src/assets/icons/delete-icon.component.svg");var d=s("./src/views/browser-view/features/send-transaction/types.ts");var u=s("./src/views/browser-view/features/send-transaction/store/index.ts");var m=s("./src/views/browser-view/features/send-transaction/components/SendTransactionDrawer/Header.tsx");var v=s("./src/stores/index.ts");var g=s("./src/views/browser-view/features/send-transaction/components/SendTransactionDrawer/AddressFormFooter.tsx");var p=s("./src/views/browser-view/features/send-transaction/constants.ts");var S=s("./src/hooks/index.ts");var f=s("./src/providers/AnalyticsProvider/analyticsTracker/index.ts");var w=s("./src/hooks/useEnterKeyPress.ts");var E=s("./src/views/browser-view/features/send-transaction/components/SendTransactionDrawer/AssetPickerFooter.tsx");var C=s("./src/views/browser-view/features/send-transaction/helpers.ts");var T=s("./src/features/address-book/components/AddressActionsModal.tsx");var h=s("./src/features/address-book/store/index.tsx");var k=s("./src/features/address-book/context/index.ts");var A=s("./src/utils/validators/index.ts");var x=s("./src/providers/index.ts");var y=s("./src/providers/AnalyticsProvider/onChain.ts");var b=s("./src/lib/wallet-api-ui.ts");var R=s("../../node_modules/@cardano-sdk/core/dist/esm/Serialization/Transaction.js");var P=s("../../packages/core/dist/index.esm.js");var D=s("./src/utils/parse-error.ts");var I=s("./src/lib/scripts/background/util.ts");var _=s("../../node_modules/@cardano-sdk/web-extension/dist/esm/walletManager/types.js");const N={[d.Sections.FORM]:"browserView.transaction.send.footer.review",[d.Sections.IMPORT_SHARED_WALLET_TRANSACTION_JSON]:"browserView.transaction.send.coSign.footer.continue",[d.Sections.SUMMARY]:"browserView.transaction.send.footer.confirm",[d.Sections.CONFIRMATION]:"browserView.transaction.send.footer.confirm",[d.Sections.SUCCESS_TX]:"browserView.transaction.send.footer.viewTransaction",[d.Sections.FAIL_TX]:"browserView.transaction.send.footer.fail",[d.Sections.UNAUTHORIZED_TX]:"browserView.transaction.send.footer.unauthorized",[d.Sections.ADDRESS_FORM]:"browserView.transaction.send.footer.save",[d.Sections.ADDRESS_CHANGE]:"addressBook.reviewModal.confirmUpdate.button"};const hasTempTxData=()=>{const{tempOutputs:e,tempAddress:t}=(0,C.getTemporaryTxDataFromStorage)();return null!==e||null!==t};const M=(0,k.withAddressBookContext)(({isPopupView:e,openContinueDialog:t,onHandleChangeConfirm:s})=>{var M,V;const F=(0,n.useRef)();const triggerSubmit=()=>{var e;return null===(e=F.current)||void 0===e?void 0:e.click()};const{t:B}=(0,o.useTranslation)();const{triggerPoint:W}=(0,u.useAnalyticsSendFlowTriggerPoint)();const{hasInvalidOutputs:H}=(0,u.useTransactionProps)();const{builtTxData:L,setBuiltTxData:j}=(0,u.useBuiltTxState)();const{setSection:O,currentSection:U}=(0,u.useSections)();const{setSubmitingTxState:Z,isSubmitingTx:G,isPasswordValid:X}=(0,u.useSubmitingState)();const{inMemoryWallet:$,isInMemoryWallet:K,walletType:Y,isSharedWallet:q,currentChain:z}=(0,v.useWalletStore)();const{password:Q,clearSecrets:J}=(0,P.useSecrets)();const[ee]=(0,u.useMetadata)();const{onClose:et,onCloseSubmitedTransaction:es}=(0,m.useHandleClose)();const en=(0,x.useAnalyticsContext)();const eo=(0,S.useNetwork)();const[ea,er]=(0,n.useState)();const[ei,el]=(0,n.useState)();const{addressToEdit:ec}=(0,h.useAddressBookStore)();const{list:ed,utils:eu}=(0,k.useAddressBookContext)();const{updateRecord:em,deleteRecord:ev}=eu;const eg=(0,S.useHandleResolver)();const{walletRepository:ep}=(0,S.useWalletManager)();const eS=(0,a.useObservable)(ep.wallets$);const ef=(0,S.useCurrentWallet)();const ew=(0,I.getParentWalletForCIP1854Account)({wallets:eS,activeWallet:ef});const eE=null==ew?void 0:null===(M=ew.wallet)||void 0===M?void 0:M.type;const eC=null==ew?void 0:null===(V=ew.account)||void 0===V?void 0:V.extendedAccountPublicKey;const eT=(0,P.useSignPolicy)(ef,"payment");const eh=U.currentSection===d.Sections.SUMMARY;const sendEventToPostHog=e=>en.sendEventToPostHog(e,{trigger_point:W,[f.TX_CREATION_TYPE_KEY]:f.TxCreationType.Internal});const ek=(0,n.useCallback)(()=>{switch(U.currentSection){case d.Sections.FORM:{const e=q?"SharedWalletsSendTxDataReviewTxClick":"SendTransactionDataReviewTransactionClick";sendEventToPostHog(f.PostHogAction[e]);break}case d.Sections.SUMMARY:{const t=q?"SharedWalletsSendTxSummaryConfirmClick":"SendTransactionSummaryConfirmClick";L.importedSharedWalletTx?sendEventToPostHog(f.PostHogAction.SharedWalletsCosignTxSummaryConfirmClick):sendEventToPostHog(f.PostHogAction[t]);break}case d.Sections.CONFIRMATION:{const s=q?"SharedWalletsSendTxConfirmationConfirmClick":"SendTransactionConfirmationConfirmClick";L.importedSharedWalletTx?sendEventToPostHog(f.PostHogAction.SharedWalletsCosignTxConfirmationClick):sendEventToPostHog(f.PostHogAction[s]);break}case d.Sections.SUCCESS_TX:{const n=q?"SharedWalletsSendAllDoneViewTxClick":"SendAllDoneViewTransactionClick";sendEventToPostHog(f.PostHogAction[n]);break}case d.Sections.UNAUTHORIZED_TX:case d.Sections.FAIL_TX:{const o=q?"SharedWalletsSendSomethingWentWrongBackClick":"SendSomethingWentWrongBackClick";sendEventToPostHog(f.PostHogAction[o]);break}case d.Sections.IMPORT_SHARED_WALLET_TRANSACTION_JSON:sendEventToPostHog(f.PostHogAction.SharedWalletsCosignTxContinueClick);break}},[U.currentSection,e,q]);const eA=(0,n.useCallback)(e=>{const t=ed.find(e=>e.address===ec.address);er(t.id);el(e);ek()},[ed,ec.address,ek]);const onHandleCancel=()=>{er(null)};const onHandleConfirm=async()=>{er(null);if("DELETE"===ei)ev(ea,{text:B("browserView.addressBook.toast.deleteAddress"),icon:c["default"]});else{const e=await (0,A.getAddressToSave)({address:ec,handleResolver:eg});await em(ea,e,{text:B("browserView.addressBook.toast.editAddress"),icon:l["default"]})}s(ei)};const ex=eE===_.WalletType.InMemory;const ey=eh&&!K&&!ex;const eb=(0,n.useCallback)(async()=>{if(q){let e;try{if(L.importedSharedWalletTx){e=R.Transaction.fromCbor(await $.addSignatures({tx:L.importedSharedWalletTx.toCbor()}));L.importedSharedWalletTx.setWitnessSet(e.witnessSet())}else{const{auxiliaryData:t,body:s,hash:n}=await L.tx.inspect();const o=await $.finalizeTx({tx:{body:s,hash:n},auxiliaryData:t});e=R.Transaction.fromCore(o)}}catch(r){a.logger.error("Shared wallet TX sign error",r);j({...L,error:(0,D.parseError)(r)});throw r}const i=(null==eT?void 0:eT.requiredCosigners)===e.toCore().witness.signatures.size;if(i){try{await $.submitTx(e.toCbor())}catch(l){a.logger.error("Shared wallet TX submit error",l);j({...L,error:(0,D.parseError)(l)});throw l}}else{await (0,P.exportMultisigTransaction)({cborHex:e.toCbor(),publicKey:eC,chainId:z})}j({...L,collectedEnoughSharedWalletTxSignatures:i})}else{let c;try{c=await L.tx.sign();await $.submitTx(c)}catch(d){a.logger.error("TX submit error",d);j({...L,error:(0,D.parseError)(d)});throw d}y.txSubmitted$.next({id:c.tx.id.toString(),date:new Date().toString(),creationType:f.TxCreationType.Internal})}},[L,z,$,q,null==eT?void 0:eT.requiredCosigners,j,eC]);const eR=(0,n.useCallback)(async e=>{if(G)return;Z({isPasswordValid:true,isSubmitingTx:true});try{await (0,b.withSignTxConfirmation)(eb,e.value);O({currentSection:d.Sections.SUCCESS_TX});Z({isPasswordValid:true,isSubmitingTx:false})}catch(t){if(t instanceof r.Wallet.KeyManagement.errors.AuthenticationError)if(ey){O({currentSection:d.Sections.UNAUTHORIZED_TX});Z({isSubmitingTx:false})}else{Z({isPasswordValid:false,isSubmitingTx:false})}else{O({currentSection:d.Sections.FAIL_TX});Z({isSubmitingTx:false})}}finally{J()}},[G,J,O,Z,eb,ey]);(0,n.useEffect)(()=>{var e;const t=r.Wallet.AVAILABLE_WALLETS.includes(Y);if(!t||"function"!=typeof(null==navigator?void 0:null===(e=navigator.hid)||void 0===e?void 0:e.addEventListener))return()=>void 0;const onHardwareWalletDisconnect=e=>{if(e.device.opened){O({currentSection:d.Sections.FAIL_TX});Z({isSubmitingTx:false})}};navigator.hid.addEventListener("disconnect",onHardwareWalletDisconnect);return()=>{navigator.hid.removeEventListener("disconnect",onHardwareWalletDisconnect)}},[O,Z,e,Y]);const eP=(0,n.useCallback)(s=>{ek();const n=U.currentSection===d.Sections.CONFIRMATION;const o=U.currentSection===d.Sections.SUCCESS_TX;const a=U.currentSection===d.Sections.FAIL_TX||U.currentSection===d.Sections.UNAUTHORIZED_TX;const r=U.currentSection===d.Sections.ADDRESS_CHANGE;if(hasTempTxData())(0,C.clearTemporaryTxDataFromStorage)();switch(true){case r:return eA("UPDATE");case eh&&!K&&!ex:if(e){return t()}return eR(s);case n:return eR(s);case o:return setTimeout(()=>es(),300);case a:Z({isPasswordValid:true});return O(p.sectionsConfig[d.Sections.FORM]);default:return O()}},[U.currentSection,eA,eR,K,ex,e,eh,es,t,ek,O,Z]);const handleClose=()=>{switch(U.currentSection){case d.Sections.SUCCESS_TX:{const e=q?"SharedWalletsSendAllDoneCloseClick":"SendAllDoneCloseClick";sendEventToPostHog(f.PostHogAction[e]);break}case d.Sections.FAIL_TX:{const t=q?"SharedWalletsSendSomethingWentWrongCancelClick":"SendSomethingWentWrongCancelClick";sendEventToPostHog(f.PostHogAction[t]);break}case d.Sections.IMPORT_SHARED_WALLET_TRANSACTION_JSON:sendEventToPostHog(f.PostHogAction.SharedWalletsCosignTxCancelClick);break;case d.Sections.SUMMARY:sendEventToPostHog(f.PostHogAction.SharedWalletsCosignTxSummaryCancelClick);break}setTimeout(()=>{et()},300)};const eD=(0,n.useMemo)(()=>{return!L.importedSharedWalletTx&&(!L.tx||H)||(null==ee?void 0:ee.length)>p.METADATA_MAX_LENGTH},[L.importedSharedWalletTx,L.tx,H,null==ee?void 0:ee.length]);const eI=(0,n.useMemo)(()=>U.currentSection===d.Sections.CONFIRMATION&&(G||!X||!Q.value||!eo),[U.currentSection,G,X,Q.value,eo]);const e_=(0,n.useMemo)(()=>{if(ey){const t=e?B("browserView.transaction.send.footer.continueInAdvancedView"):B("browserView.transaction.send.footer.confirmWithDevice",{hardwareWallet:eE||Y});return G?B("browserView.transaction.send.footer.signing"):t}if(q&&U.currentSection===d.Sections.SUCCESS_TX){return B("general.button.view-co-signers")}return B(N[U.currentSection])},[ey,q,U.currentSection,B,e,eE,Y,G]);const eN=(0,n.useMemo)(()=>{if(U.currentSection===d.Sections.SUCCESS_TX){return B("browserView.transaction.send.footer.close")}if(U.currentSection===d.Sections.ADDRESS_CHANGE){return B("addressBook.reviewModal.cancelUpdate.button")}return B("browserView.transaction.send.footer.cancel")},[B,U.currentSection]);const eM=(eD||eI)&&U.currentSection!==d.Sections.ADDRESS_CHANGE;const eV=(0,n.useCallback)(()=>{triggerSubmit()},[]);(0,n.useEffect)(()=>{const cleanup=()=>{if(hasTempTxData())(0,C.clearTemporaryTxDataFromStorage)()};if(e)return cleanup;if(G)return cleanup;if(eM)return cleanup;const{tempSource:t}=(0,C.getTemporaryTxDataFromStorage)();if(hasTempTxData()&&"hardware-wallet"===t)eV()},[eM,ey,e,G,eV]);if([d.Sections.ADDRESS_LIST,d.Sections.ADDRESS_FORM].includes(U.currentSection))return null;if(U.currentSection===d.Sections.ASSET_PICKER)return n.createElement(E.AssetPickerFooter,null);if(U.currentSection===d.Sections.ADDRESS_FORM)return n.createElement(g.AddressFormFooter,null);return n.createElement(n.Fragment,null,n.createElement("div",{className:i["default"].footer},n.createElement(a.Button,{size:"large",block:true,disabled:eM,loading:G,onClick:()=>eP(Q),ref:F,id:w.buttonIds.sendNextBtnId,"data-testid":"send-next-btn"},e_),n.createElement(a.Button,{color:"secondary",size:"large",block:true,onClick:U.currentSection===d.Sections.ADDRESS_CHANGE?()=>eA("DELETE"):handleClose,"data-testid":"send-cancel-btn"},eN)),n.createElement(T.AddressActionsModal,{action:ei,onCancel:onHandleCancel,onConfirm:onHandleConfirm,visible:!!ea,isPopup:e}))})},"./src/views/browser-view/features/staking/components/StakingModals/StakingModals.tsx":(e,t,s)=>{var n=s("../../node_modules/react/index.js");var o=s("../../node_modules/react-i18next/dist/es/index.js");var a=s("./src/views/browser-view/stores/index.ts");var r=s("./src/views/browser-view/components/Drawer/DrawerUIContent.tsx");var i=s("./src/views/browser-view/features/staking/store/index.ts");var l=s("./src/views/browser-view/features/staking/types/index.ts");var c=s("./src/views/browser-view/features/staking/components/StakingModals/StakingModal.tsx");var d=s("./src/providers/AnalyticsProvider/analyticsTracker/index.ts");var u=s("./src/providers/index.ts");var m=s("../../packages/common/dist/index.esm.js");const StakingModals=({popupView:e})=>{const{t}=useTranslation();const{isNoFundsVisible:s,setNoFundsVisible:n,isExitStakingVisible:o,setExitStakingVisible:a,setStakeConfirmationVisible:r,isStakeConfirmationVisible:i,setIsDrawerVisible:l,setSection:c,resetStates:d}=useStakePoolDetails();const[,u]=useDrawer();const m=useAnalyticsContext();return React.createElement(React.Fragment,null,React.createElement(StakingModal,{visible:i,title:t("browserView.staking.details.switchingPoolsModal.title"),description:t("browserView.staking.details.switchingPoolsModal.description"),actions:[{body:t("browserView.staking.details.switchingPoolsModal.buttons.cancel"),dataTestId:"switch-pools-modal-cancel",color:"secondary",onClick:()=>r(false)},{dataTestId:"switch-pools-modal-confirm",onClick:()=>{m.sendEventToPostHog(PostHogAction.StakingSwitchingPoolFineByMeClick);r(false);c(sectionsConfig[Sections.CONFIRMATION]);l(true)},body:t("browserView.staking.details.switchingPoolsModal.buttons.confirm")}],popupView:e}),React.createElement(StakingModal,{visible:o,title:t("browserView.staking.details.exitStakingModal.title"),description:t("browserView.staking.details.exitStakingModal.description"),actions:[{body:t("browserView.staking.details.exitStakingModal.buttons.cancel"),dataTestId:"exit-staking-modal-cancel",onClick:()=>a(false),color:"secondary"},{body:t("browserView.staking.details.exitStakingModal.buttons.confirm"),dataTestId:"exit-staking-modal-confirm",onClick:()=>{a(false);l(false);d()}}],popupView:e}),React.createElement(StakingModal,{visible:s,title:t("browserView.staking.details.noFundsModal.title"),description:t("browserView.staking.details.noFundsModal.description"),actions:[{body:t("browserView.staking.details.noFundsModal.buttons.cancel"),dataTestId:"no-funds-modal-cancel",onClick:()=>n(false),color:"secondary"},{body:t("browserView.staking.details.noFundsModal.buttons.confirm"),dataTestId:"no-funds-modal-confirm",onClick:()=>{n(false);u({content:DrawerContent.RECEIVE_TRANSACTION,renderHeader:()=>React.createElement(DrawerNavigation,{title:t("qrInfo.receive"),onCloseIconClick:()=>u()}),renderTitle:()=>React.createElement(DrawerHeader,{title:t("qrInfo.title"),subtitle:t("qrInfo.scanQRCodeToConnectWallet")})});l(false)}}],popupView:e}))}},"./src/views/browser-view/features/staking/types/index.ts":(e,t,s)=>{s.d(t,{Sections:()=>n.Sections,StakingErrorType:()=>n.StakingErrorType});var n=s("./src/views/browser-view/features/staking/types/stakingStore.ts")}}]);
//# sourceMappingURL=20.js.map